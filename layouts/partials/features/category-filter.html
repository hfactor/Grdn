<div class="category-filter custom-select">
  <div class="select-selected">All Categories</div>
  <div class="select-items">
    <div class="select-item selected" data-value="">
      <span class="item-label">All Categories</span>
    </div>
    {{ $categories := slice }}
    {{ range .Site.RegularPages }}
      {{ with .Params.category }}
        {{ $categories = $categories | append . }}
      {{ end }}
    {{ end }}
    {{ range ($categories | uniq | sort) }}
      {{ $count := len (where $.Site.RegularPages "Params.category" .) }}
      <div class="select-item" data-value="{{ . }}">
        <span class="item-label">{{ . }}</span>
        <span class="item-count">({{ $count }})</span>
      </div>
    {{ end }}
  </div>
</div> 